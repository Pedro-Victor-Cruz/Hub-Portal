<div class="invite-container">
  <div class="background-wrapper">
    <!-- Ícones flutuantes -->
    <div class="floating-icons">
      <div class="icon-box icon-1 primary">
        <i class='bx bx-group'></i>
      </div>
      <div class="icon-box icon-2 secondary">
        <i class='bx bx-envelope'></i>
      </div>
      <div class="icon-box icon-3 primary">
        <i class='bx bx-user-plus'></i>
      </div>
      <div class="icon-box icon-4 secondary">
        <i class='bx bx-briefcase'></i>
      </div>
      <div class="icon-box icon-5 muted">
        <i class='bx bx-shield-alt-2'></i>
      </div>
      <div class="icon-box icon-6 primary">
        <i class='bx bx-check-circle'></i>
      </div>
      <div class="icon-box icon-7 secondary">
        <i class='bx bx-buildings'></i>
      </div>
      <div class="icon-box icon-8 muted">
        <i class='bx bx-network-chart'></i>
      </div>
    </div>

    <!-- Card de convite -->
    <div class="invite-card-wrapper">
      <div class="invite-card">
        <!-- Logo -->
        <div class="logo-container">
          <img src="assets/uaibits.png" alt="UaiBits Logo" class="company-logo">
        </div>

        <!-- Loading State -->
        @if (loading && !accepting) {
          <div class="loading-state">
            <div class="spinner"></div>
            <p class="loading-text">Carregando convite...</p>
          </div>
        }

        <!-- Error State -->
        @if (error && !loading) {
          <div class="error-state">
            <div class="error-icon">
              <i class='bx bx-error-circle'></i>
            </div>
            <h2 class="error-title">Ops! Algo deu errado</h2>
            <p class="error-message">{{ error }}</p>
            <button class="btn-retry" (click)="loadInvite()">
              <i class='bx bx-refresh'></i>
              Tentar Novamente
            </button>
          </div>
        }

        <!-- Success State - Invitation Info -->
        @if (infoData && !loading && !error) {
          <div class="invite-content">
            <div class="invite-icon">
              <i class='bx bx-envelope-open'></i>
            </div>

            <h1 class="invite-title">Você foi convidado!</h1>

            <div class="invite-details">
              <div class="detail-item">
                <div class="detail-icon">
                  <i class='bx bx-buildings'></i>
                </div>
                <div class="detail-info">
                  <span class="detail-label">Projeto</span>
                  <span class="detail-value">{{ infoData.client_name }}</span>
                </div>
              </div>

              <div class="detail-item">
                <div class="detail-icon">
                  <i class='bx bx-envelope'></i>
                </div>
                <div class="detail-info">
                  <span class="detail-label">E-mail convidado</span>
                  <span class="detail-value">{{ infoData.invited_email }}</span>
                </div>
              </div>
            </div>

            <!-- Mensagem informativa baseada no estado -->
            @if (!infoData.is_authenticated && !infoData.existing_user) {
              <div class="invite-message info">
                <div class="message-icon">
                  <i class='bx bx-user-plus'></i>
                </div>
                <div class="message-content">
                  <h3>Bem-vindo!</h3>
                  <p>Como é a primeira vez que você acessa nossa plataforma, precisamos que você crie uma conta primeiro. É rápido e fácil!</p>
                </div>
              </div>
            }

            @if (!infoData.is_authenticated && infoData.existing_user) {
              <div class="invite-message info">
                <div class="message-icon">
                  <i class='bx bx-log-in'></i>
                </div>
                <div class="message-content">
                  <h3>Olá novamente!</h3>
                  <p>Identificamos que você já possui uma conta. Faça login para continuar e aceitar o convite do projeto <strong>{{ infoData.client_name }}</strong>.</p>
                </div>
              </div>
            }

            @if (infoData.is_authenticated) {
              <div class="invite-message success">
                <div class="message-icon">
                  <i class='bx bx-check-shield'></i>
                </div>
                <div class="message-content">
                  <h3>Tudo pronto!</h3>
                  <p>Você está autenticado e pode aceitar o convite agora. Ao aceitar, você terá acesso aos projetos e recursos do projeto <strong>{{ infoData.client_name }}</strong>.</p>
                </div>
              </div>
            }

            <!-- Botões de ação -->
            <div class="action-buttons">
              @if (!infoData.is_authenticated && !infoData.existing_user) {
                <button class="btn-primary" (click)="goToRegister()">
                  <i class='bx bx-user-plus'></i>
                  Criar Conta
                </button>
              }

              @if (!infoData.is_authenticated && infoData.existing_user) {
                <button class="btn-primary" (click)="goToLogin()">
                  <i class='bx bx-log-in'></i>
                  Fazer Login
                </button>
              }

              @if (infoData.is_authenticated) {
                <button
                  class="btn-accept"
                  (click)="acceptInvite()"
                  [disabled]="accepting">
                  @if (accepting) {
                    <div class="btn-spinner"></div>
                    <span>Aceitando...</span>
                  } @else {
                    <i class='bx bx-check'></i>
                    <span>Aceitar Convite</span>
                  }
                </button>
              }
            </div>
          </div>
        }
      </div>
    </div>

    <!-- Copyright -->
    <div class="copyright">
      <p>© {{ currentYear }} UaiBits. Todos os direitos reservados.</p>
    </div>
  </div>
</div>
