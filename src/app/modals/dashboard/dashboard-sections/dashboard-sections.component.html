<!-- dasboard-scetions.component.html -->
<div class="dashboard-sections-container">

  <!-- Cabeçalho com ações -->
  <div class="sections-header">
    <div>
      <h3>Estrutura do Dashboard</h3>
      <p class="text-muted">Organize seções em hierarquia e adicione widgets</p>
    </div>
    <ub-button
      icon="bx bx-plus"
      (click)="addRootSection()">Adicionar Seção</ub-button>
  </div>

  <!-- Barra de busca -->
  <div class="search-bar">
    <ub-input
      [(ngModel)]="searchQuery"
      placeholder="Buscar seções..."
      (ngModelChange)="filterSections()">
    </ub-input>
  </div>

  <!-- Lista de Seções -->
  @if (loading) {
    <div class="loading-state">
      <i class="bx bx-loader-alt bx-spin"></i>
      <span>Carregando estrutura...</span>
    </div>
  } @else if (folderItems.length === 0) {
    <div class="empty-state">
      <i class="bx bx-folder-open"></i>
      <h4>Nenhuma seção criada</h4>
      <p>Comece criando uma seção raiz para organizar seus widgets</p>
      <ub-button
        icon="bx bx-plus"
        (click)="addRootSection()">Criar Primeira Seção</ub-button>
    </div>
  } @else {
    <!-- Lista de seções com ações -->
    <div class="sections-list">
      @for (item of folderItems; track item.id) {
        <div class="section-item" [class.inactive]="!item.active">
          <div class="section-info">
            <i class="bx {{ item.icon }}"></i>
            <div class="section-content">
              <h4>{{ item.name }}</h4>
              @if (item.description) {
                <p class="description">{{ item.description }}</p>
              }
              <div class="meta">
                <span class="badge badge-level">Nível {{ item.level }}</span>
                <span class="badge badge-order">Ordem: {{ item.order }}</span>
                @if (!item.active) {
                  <span class="badge badge-warning">Inativa</span>
                }
              </div>
            </div>
          </div>

          <!-- Ações -->
          <div class="section-actions">
            <button
              class="action-btn"
              title="Adicionar Subseção"
              (click)="addChildSection(item)">
              <i class="bx bx-plus"></i>
            </button>
            <button
              class="action-btn"
              title="Gerenciar Widgets"
              (click)="manageWidgets(item)">
              <i class="bx bx-layout"></i>
            </button>
            <button
              class="action-btn"
              title="Editar"
              (click)="editSection(item)">
              <i class="bx bx-edit"></i>
            </button>
            <button
              class="action-btn"
              title="Duplicar"
              (click)="duplicateSection(item)">
              <i class="bx bx-copy"></i>
            </button>
            <button
              class="action-btn danger"
              title="Excluir"
              (click)="deleteSection(item)">
              <i class="bx bx-trash"></i>
            </button>
          </div>
        </div>
      }
    </div>
  }

</div>
